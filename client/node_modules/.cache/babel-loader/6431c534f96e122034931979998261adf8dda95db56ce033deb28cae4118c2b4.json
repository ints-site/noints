{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\FanYukin\\\\codes\\\\f\\\\noints\\\\client\\\\src\\\\components\\\\Editor\\\\Toolbar.tsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useSlate } from 'slate-react';\nimport { Editor, Element as SlateElement, Transforms } from 'slate';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FormatButton = ({\n  format,\n  icon,\n  onClick,\n  isActive\n}) => /*#__PURE__*/_jsxDEV(\"button\", {\n  className: `p-1 rounded ${isActive ? 'bg-gray-200' : 'hover:bg-gray-100'}`,\n  onMouseDown: e => {\n    e.preventDefault();\n    onClick();\n  },\n  title: format,\n  children: /*#__PURE__*/_jsxDEV(\"span\", {\n    className: \"material-icons\",\n    children: icon\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 24,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 14,\n  columnNumber: 3\n}, this);\n_c = FormatButton;\nconst isMarkFormat = format => {\n  return ['bold', 'italic', 'underline'].includes(format);\n};\nconst isCustomElement = node => {\n  return SlateElement.isElement(node) && 'type' in node;\n};\nconst Toolbar = () => {\n  _s();\n  const editor = useSlate();\n\n  // 检查当前选中文本的格式\n  const isFormatActive = format => {\n    if (isMarkFormat(format)) {\n      const marks = Editor.marks(editor);\n      return marks ? !!marks[format] : false;\n    } else {\n      const [match] = Array.from(Editor.nodes(editor, {\n        match: n => isCustomElement(n) && n.type === format\n      }));\n      return !!match;\n    }\n  };\n\n  // 切换文本格式\n  const toggleFormat = format => {\n    const isActive = isFormatActive(format);\n    if (isActive) {\n      Editor.removeMark(editor, format);\n    } else {\n      Editor.addMark(editor, format, true);\n    }\n  };\n\n  // 切换列表格式\n  const toggleList = format => {\n    const isActive = isFormatActive(format);\n    Transforms.setNodes(editor, {\n      type: isActive ? 'paragraph' : format\n    }, {\n      match: n => SlateElement.isElement(n) && (!('type' in n) || isCustomElement(n)),\n      mode: 'highest'\n    });\n  };\n\n  // 添加撤销/重做功能\n  const handleUndo = () => {\n    editor.undo();\n  };\n  const handleRedo = () => {\n    editor.redo();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"border-b p-2 flex gap-2 items-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex gap-1 mr-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"p-1 rounded hover:bg-gray-100\",\n        onMouseDown: e => {\n          e.preventDefault();\n          handleUndo();\n        },\n        title: \"Undo (Ctrl+Z)\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"material-icons\",\n          children: \"undo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"p-1 rounded hover:bg-gray-100\",\n        onMouseDown: e => {\n          e.preventDefault();\n          handleRedo();\n        },\n        title: \"Redo (Ctrl+Y)\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"material-icons\",\n          children: \"redo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-px bg-gray-300 h-6\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FormatButton, {\n      format: \"bold\",\n      icon: \"format_bold\",\n      onClick: () => toggleFormat('bold'),\n      isActive: isFormatActive('bold')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FormatButton, {\n      format: \"italic\",\n      icon: \"format_italic\",\n      onClick: () => toggleFormat('italic'),\n      isActive: isFormatActive('italic')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FormatButton, {\n      format: \"underline\",\n      icon: \"format_underlined\",\n      onClick: () => toggleFormat('underline'),\n      isActive: isFormatActive('underline')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-px bg-gray-300 mx-2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FormatButton, {\n      format: \"bulleted-list\",\n      icon: \"format_list_bulleted\",\n      onClick: () => toggleList('bulleted-list'),\n      isActive: isFormatActive('bulleted-list')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FormatButton, {\n      format: \"numbered-list\",\n      icon: \"format_list_numbered\",\n      onClick: () => toggleList('numbered-list'),\n      isActive: isFormatActive('numbered-list')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n};\n_s(Toolbar, \"YMFVEh3YGumTkrWAgpqmxHJ20Oc=\", false, function () {\n  return [useSlate];\n});\n_c2 = Toolbar;\nexport default Toolbar;\nvar _c, _c2;\n$RefreshReg$(_c, \"FormatButton\");\n$RefreshReg$(_c2, \"Toolbar\");","map":{"version":3,"names":["React","useSlate","Editor","Element","SlateElement","Transforms","jsxDEV","_jsxDEV","FormatButton","format","icon","onClick","isActive","className","onMouseDown","e","preventDefault","title","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","isMarkFormat","includes","isCustomElement","node","isElement","Toolbar","_s","editor","isFormatActive","marks","match","Array","from","nodes","n","type","toggleFormat","removeMark","addMark","toggleList","setNodes","mode","handleUndo","undo","handleRedo","redo","_c2","$RefreshReg$"],"sources":["C:/Users/FanYukin/codes/f/noints/client/src/components/Editor/Toolbar.tsx"],"sourcesContent":["import React from 'react';\r\nimport { useSlate } from 'slate-react';\r\nimport { Editor, Element as SlateElement, Node, Transforms } from 'slate';\r\nimport { CustomElement, CustomText, FormatType, MarkFormatType, BlockFormatType } from './types';\r\n\r\ninterface FormatButtonProps {\r\n  format: FormatType;\r\n  icon: string;\r\n  onClick: () => void;\r\n  isActive?: boolean;\r\n}\r\n\r\nconst FormatButton: React.FC<FormatButtonProps> = ({ format, icon, onClick, isActive }) => (\r\n  <button\r\n    className={`p-1 rounded ${\r\n      isActive ? 'bg-gray-200' : 'hover:bg-gray-100'\r\n    }`}\r\n    onMouseDown={(e) => {\r\n      e.preventDefault();\r\n      onClick();\r\n    }}\r\n    title={format}\r\n  >\r\n    <span className=\"material-icons\">{icon}</span>\r\n  </button>\r\n);\r\n\r\nconst isMarkFormat = (format: FormatType): format is MarkFormatType => {\r\n  return ['bold', 'italic', 'underline'].includes(format);\r\n};\r\n\r\nconst isCustomElement = (node: Node): node is CustomElement => {\r\n  return SlateElement.isElement(node) && 'type' in node;\r\n};\r\n\r\nconst Toolbar: React.FC = () => {\r\n  const editor = useSlate();\r\n\r\n  // 检查当前选中文本的格式\r\n  const isFormatActive = (format: FormatType) => {\r\n    if (isMarkFormat(format)) {\r\n      const marks = Editor.marks(editor) as Partial<CustomText> | null;\r\n      return marks ? !!marks[format] : false;\r\n    } else {\r\n      const [match] = Array.from(Editor.nodes(editor, {\r\n        match: n => \r\n          isCustomElement(n) && n.type === format,\r\n      }));\r\n      return !!match;\r\n    }\r\n  };\r\n\r\n  // 切换文本格式\r\n  const toggleFormat = (format: MarkFormatType) => {\r\n    const isActive = isFormatActive(format);\r\n    if (isActive) {\r\n      Editor.removeMark(editor, format);\r\n    } else {\r\n      Editor.addMark(editor, format, true);\r\n    }\r\n  };\r\n\r\n  // 切换列表格式\r\n  const toggleList = (format: BlockFormatType) => {\r\n    const isActive = isFormatActive(format);\r\n\r\n    Transforms.setNodes(\r\n      editor,\r\n      { type: isActive ? 'paragraph' : format },\r\n      { \r\n        match: n => SlateElement.isElement(n) && (!('type' in n) || isCustomElement(n)),\r\n        mode: 'highest'\r\n      }\r\n    );\r\n  };\r\n\r\n  // 添加撤销/重做功能\r\n  const handleUndo = () => {\r\n    editor.undo();\r\n  };\r\n\r\n  const handleRedo = () => {\r\n    editor.redo();\r\n  };\r\n\r\n  return (\r\n    <div className=\"border-b p-2 flex gap-2 items-center\">\r\n      {/* 撤销/重做按钮 */}\r\n      <div className=\"flex gap-1 mr-2\">\r\n        <button\r\n          className=\"p-1 rounded hover:bg-gray-100\"\r\n          onMouseDown={(e) => {\r\n            e.preventDefault();\r\n            handleUndo();\r\n          }}\r\n          title=\"Undo (Ctrl+Z)\"\r\n        >\r\n          <span className=\"material-icons\">undo</span>\r\n        </button>\r\n        <button\r\n          className=\"p-1 rounded hover:bg-gray-100\"\r\n          onMouseDown={(e) => {\r\n            e.preventDefault();\r\n            handleRedo();\r\n          }}\r\n          title=\"Redo (Ctrl+Y)\"\r\n        >\r\n          <span className=\"material-icons\">redo</span>\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"w-px bg-gray-300 h-6\" />\r\n\r\n      {/* 现有的格式化按钮 */}\r\n      <FormatButton\r\n        format=\"bold\"\r\n        icon=\"format_bold\"\r\n        onClick={() => toggleFormat('bold')}\r\n        isActive={isFormatActive('bold')}\r\n      />\r\n      <FormatButton\r\n        format=\"italic\"\r\n        icon=\"format_italic\"\r\n        onClick={() => toggleFormat('italic')}\r\n        isActive={isFormatActive('italic')}\r\n      />\r\n      <FormatButton\r\n        format=\"underline\"\r\n        icon=\"format_underlined\"\r\n        onClick={() => toggleFormat('underline')}\r\n        isActive={isFormatActive('underline')}\r\n      />\r\n      \r\n      <div className=\"w-px bg-gray-300 mx-2\" />\r\n      \r\n      <FormatButton\r\n        format=\"bulleted-list\"\r\n        icon=\"format_list_bulleted\"\r\n        onClick={() => toggleList('bulleted-list')}\r\n        isActive={isFormatActive('bulleted-list')}\r\n      />\r\n      <FormatButton\r\n        format=\"numbered-list\"\r\n        icon=\"format_list_numbered\"\r\n        onClick={() => toggleList('numbered-list')}\r\n        isActive={isFormatActive('numbered-list')}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Toolbar; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}