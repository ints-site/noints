{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\FanYukin\\\\codes\\\\f\\\\noints\\\\client\\\\src\\\\components\\\\Editor\\\\NoteEditor.tsx\",\n  _s = $RefreshSig$();\nimport React, { useMemo, useState, useCallback } from 'react';\nimport { createEditor } from 'slate';\nimport { Slate, Editable, withReact } from 'slate-react';\nimport { withHistory } from 'slate-history';\nimport { useAutoSave } from '../../hooks/useAutoSave';\nimport Toolbar from './Toolbar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NoteEditor = ({\n  noteId\n}) => {\n  _s();\n  const editor = useMemo(() => withHistory(withReact(createEditor())), []);\n  const [value, setValue] = useState([{\n    type: 'paragraph',\n    children: [{\n      text: ''\n    }]\n  }]);\n\n  // 使用自动保存 hook\n  useAutoSave(noteId || null, value);\n\n  // 渲染元素\n  const renderElement = useCallback(props => {\n    const {\n      element,\n      attributes,\n      children\n    } = props;\n    switch (element.type) {\n      case 'bulleted-list':\n        return /*#__PURE__*/_jsxDEV(\"ul\", {\n          ...attributes,\n          children: children\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 30,\n          columnNumber: 16\n        }, this);\n      case 'numbered-list':\n        return /*#__PURE__*/_jsxDEV(\"ol\", {\n          ...attributes,\n          children: children\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 32,\n          columnNumber: 16\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          ...attributes,\n          children: children\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 34,\n          columnNumber: 16\n        }, this);\n    }\n  }, []);\n\n  // 渲染叶子节点（文本）\n  const renderLeaf = useCallback(props => {\n    const {\n      attributes,\n      leaf,\n      children\n    } = props;\n    let element = children;\n    if (leaf.bold) {\n      element = /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: element\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 17\n      }, this);\n    }\n    if (leaf.italic) {\n      element = /*#__PURE__*/_jsxDEV(\"em\", {\n        children: element\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 17\n      }, this);\n    }\n    if (leaf.underline) {\n      element = /*#__PURE__*/_jsxDEV(\"u\", {\n        children: element\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 17\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"span\", {\n      ...attributes,\n      children: element\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 12\n    }, this);\n  }, []);\n\n  // 处理按键事件\n  const handleKeyDown = event => {\n    if (!event.ctrlKey) return;\n    switch (event.key) {\n      case 'b':\n        {\n          event.preventDefault();\n          Editor.addMark(editor, 'bold', true);\n          break;\n        }\n      case 'i':\n        {\n          event.preventDefault();\n          Editor.addMark(editor, 'italic', true);\n          break;\n        }\n      case 'u':\n        {\n          event.preventDefault();\n          Editor.addMark(editor, 'underline', true);\n          break;\n        }\n      case 'z':\n        {\n          event.preventDefault();\n          if (event.shiftKey) {\n            editor.redo();\n          } else {\n            editor.undo();\n          }\n          break;\n        }\n      case 'y':\n        {\n          event.preventDefault();\n          editor.redo();\n          break;\n        }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-full flex flex-col\",\n    children: /*#__PURE__*/_jsxDEV(Slate, {\n      editor: editor,\n      value: value,\n      onChange: newValue => {\n        setValue(newValue);\n      },\n      children: [/*#__PURE__*/_jsxDEV(Toolbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 p-6 overflow-auto\",\n        children: /*#__PURE__*/_jsxDEV(Editable, {\n          className: \"h-full outline-none prose max-w-none\",\n          renderElement: renderElement,\n          renderLeaf: renderLeaf,\n          placeholder: \"Start typing...\",\n          onKeyDown: handleKeyDown,\n          spellCheck: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n};\n_s(NoteEditor, \"w4xX2aF7YxO31bWQgK0qSnA31AU=\", false, function () {\n  return [useAutoSave];\n});\n_c = NoteEditor;\nexport default NoteEditor;\nvar _c;\n$RefreshReg$(_c, \"NoteEditor\");","map":{"version":3,"names":["React","useMemo","useState","useCallback","createEditor","Slate","Editable","withReact","withHistory","useAutoSave","Toolbar","jsxDEV","_jsxDEV","NoteEditor","noteId","_s","editor","value","setValue","type","children","text","renderElement","props","element","attributes","fileName","_jsxFileName","lineNumber","columnNumber","renderLeaf","leaf","bold","italic","underline","handleKeyDown","event","ctrlKey","key","preventDefault","Editor","addMark","shiftKey","redo","undo","className","onChange","newValue","placeholder","onKeyDown","spellCheck","_c","$RefreshReg$"],"sources":["C:/Users/FanYukin/codes/f/noints/client/src/components/Editor/NoteEditor.tsx"],"sourcesContent":["import React, { useMemo, useState, useCallback } from 'react';\r\nimport { createEditor, Descendant } from 'slate';\r\nimport { Slate, Editable, withReact } from 'slate-react';\r\nimport { withHistory } from 'slate-history';\r\nimport { useAutoSave } from '../../hooks/useAutoSave';\r\nimport Toolbar from './Toolbar';\r\nimport { CustomElement, CustomText } from './types';\r\n\r\nconst NoteEditor: React.FC<{ noteId?: string }> = ({ noteId }) => {\r\n  const editor = useMemo(() => withHistory(withReact(createEditor())), []);\r\n  const [value, setValue] = useState<Descendant[]>([\r\n    {\r\n      type: 'paragraph',\r\n      children: [{ text: '' }],\r\n    },\r\n  ]);\r\n\r\n  // 使用自动保存 hook\r\n  useAutoSave(noteId || null, value);\r\n\r\n  // 渲染元素\r\n  const renderElement = useCallback((props: {\r\n    element: CustomElement;\r\n    children: React.ReactNode;\r\n    attributes: any;\r\n  }) => {\r\n    const { element, attributes, children } = props;\r\n    switch (element.type) {\r\n      case 'bulleted-list':\r\n        return <ul {...attributes}>{children}</ul>;\r\n      case 'numbered-list':\r\n        return <ol {...attributes}>{children}</ol>;\r\n      default:\r\n        return <p {...attributes}>{children}</p>;\r\n    }\r\n  }, []);\r\n\r\n  // 渲染叶子节点（文本）\r\n  const renderLeaf = useCallback((props: {\r\n    leaf: CustomText;\r\n    children: React.ReactNode;\r\n    attributes: any;\r\n  }) => {\r\n    const { attributes, leaf, children } = props;\r\n    let element = children;\r\n\r\n    if (leaf.bold) {\r\n      element = <strong>{element}</strong>;\r\n    }\r\n    if (leaf.italic) {\r\n      element = <em>{element}</em>;\r\n    }\r\n    if (leaf.underline) {\r\n      element = <u>{element}</u>;\r\n    }\r\n\r\n    return <span {...attributes}>{element}</span>;\r\n  }, []);\r\n\r\n  // 处理按键事件\r\n  const handleKeyDown = (event: React.KeyboardEvent) => {\r\n    if (!event.ctrlKey) return;\r\n\r\n    switch (event.key) {\r\n      case 'b': {\r\n        event.preventDefault();\r\n        Editor.addMark(editor, 'bold', true);\r\n        break;\r\n      }\r\n      case 'i': {\r\n        event.preventDefault();\r\n        Editor.addMark(editor, 'italic', true);\r\n        break;\r\n      }\r\n      case 'u': {\r\n        event.preventDefault();\r\n        Editor.addMark(editor, 'underline', true);\r\n        break;\r\n      }\r\n      case 'z': {\r\n        event.preventDefault();\r\n        if (event.shiftKey) {\r\n          editor.redo();\r\n        } else {\r\n          editor.undo();\r\n        }\r\n        break;\r\n      }\r\n      case 'y': {\r\n        event.preventDefault();\r\n        editor.redo();\r\n        break;\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      <Slate\r\n        editor={editor}\r\n        value={value}\r\n        onChange={newValue => {\r\n          setValue(newValue);\r\n        }}\r\n      >\r\n        <Toolbar />\r\n        <div className=\"flex-1 p-6 overflow-auto\">\r\n          <Editable\r\n            className=\"h-full outline-none prose max-w-none\"\r\n            renderElement={renderElement}\r\n            renderLeaf={renderLeaf}\r\n            placeholder=\"Start typing...\"\r\n            onKeyDown={handleKeyDown}\r\n            spellCheck={false}\r\n          />\r\n        </div>\r\n      </Slate>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NoteEditor; "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,OAAO,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AAC7D,SAASC,YAAY,QAAoB,OAAO;AAChD,SAASC,KAAK,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,aAAa;AACxD,SAASC,WAAW,QAAQ,eAAe;AAC3C,SAASC,WAAW,QAAQ,yBAAyB;AACrD,OAAOC,OAAO,MAAM,WAAW;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAGhC,MAAMC,UAAyC,GAAGA,CAAC;EAAEC;AAAO,CAAC,KAAK;EAAAC,EAAA;EAChE,MAAMC,MAAM,GAAGf,OAAO,CAAC,MAAMO,WAAW,CAACD,SAAS,CAACH,YAAY,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;EACxE,MAAM,CAACa,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,QAAQ,CAAe,CAC/C;IACEiB,IAAI,EAAE,WAAW;IACjBC,QAAQ,EAAE,CAAC;MAAEC,IAAI,EAAE;IAAG,CAAC;EACzB,CAAC,CACF,CAAC;;EAEF;EACAZ,WAAW,CAACK,MAAM,IAAI,IAAI,EAAEG,KAAK,CAAC;;EAElC;EACA,MAAMK,aAAa,GAAGnB,WAAW,CAAEoB,KAIlC,IAAK;IACJ,MAAM;MAAEC,OAAO;MAAEC,UAAU;MAAEL;IAAS,CAAC,GAAGG,KAAK;IAC/C,QAAQC,OAAO,CAACL,IAAI;MAClB,KAAK,eAAe;QAClB,oBAAOP,OAAA;UAAA,GAAQa,UAAU;UAAAL,QAAA,EAAGA;QAAQ;UAAAM,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC;MAC5C,KAAK,eAAe;QAClB,oBAAOjB,OAAA;UAAA,GAAQa,UAAU;UAAAL,QAAA,EAAGA;QAAQ;UAAAM,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC;MAC5C;QACE,oBAAOjB,OAAA;UAAA,GAAOa,UAAU;UAAAL,QAAA,EAAGA;QAAQ;UAAAM,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC;IAC5C;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMC,UAAU,GAAG3B,WAAW,CAAEoB,KAI/B,IAAK;IACJ,MAAM;MAAEE,UAAU;MAAEM,IAAI;MAAEX;IAAS,CAAC,GAAGG,KAAK;IAC5C,IAAIC,OAAO,GAAGJ,QAAQ;IAEtB,IAAIW,IAAI,CAACC,IAAI,EAAE;MACbR,OAAO,gBAAGZ,OAAA;QAAAQ,QAAA,EAASI;MAAO;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAS,CAAC;IACtC;IACA,IAAIE,IAAI,CAACE,MAAM,EAAE;MACfT,OAAO,gBAAGZ,OAAA;QAAAQ,QAAA,EAAKI;MAAO;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC;IAC9B;IACA,IAAIE,IAAI,CAACG,SAAS,EAAE;MAClBV,OAAO,gBAAGZ,OAAA;QAAAQ,QAAA,EAAII;MAAO;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC;IAC5B;IAEA,oBAAOjB,OAAA;MAAA,GAAUa,UAAU;MAAAL,QAAA,EAAGI;IAAO;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAO,CAAC;EAC/C,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMM,aAAa,GAAIC,KAA0B,IAAK;IACpD,IAAI,CAACA,KAAK,CAACC,OAAO,EAAE;IAEpB,QAAQD,KAAK,CAACE,GAAG;MACf,KAAK,GAAG;QAAE;UACRF,KAAK,CAACG,cAAc,CAAC,CAAC;UACtBC,MAAM,CAACC,OAAO,CAACzB,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC;UACpC;QACF;MACA,KAAK,GAAG;QAAE;UACRoB,KAAK,CAACG,cAAc,CAAC,CAAC;UACtBC,MAAM,CAACC,OAAO,CAACzB,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC;UACtC;QACF;MACA,KAAK,GAAG;QAAE;UACRoB,KAAK,CAACG,cAAc,CAAC,CAAC;UACtBC,MAAM,CAACC,OAAO,CAACzB,MAAM,EAAE,WAAW,EAAE,IAAI,CAAC;UACzC;QACF;MACA,KAAK,GAAG;QAAE;UACRoB,KAAK,CAACG,cAAc,CAAC,CAAC;UACtB,IAAIH,KAAK,CAACM,QAAQ,EAAE;YAClB1B,MAAM,CAAC2B,IAAI,CAAC,CAAC;UACf,CAAC,MAAM;YACL3B,MAAM,CAAC4B,IAAI,CAAC,CAAC;UACf;UACA;QACF;MACA,KAAK,GAAG;QAAE;UACRR,KAAK,CAACG,cAAc,CAAC,CAAC;UACtBvB,MAAM,CAAC2B,IAAI,CAAC,CAAC;UACb;QACF;IACF;EACF,CAAC;EAED,oBACE/B,OAAA;IAAKiC,SAAS,EAAC,sBAAsB;IAAAzB,QAAA,eACnCR,OAAA,CAACP,KAAK;MACJW,MAAM,EAAEA,MAAO;MACfC,KAAK,EAAEA,KAAM;MACb6B,QAAQ,EAAEC,QAAQ,IAAI;QACpB7B,QAAQ,CAAC6B,QAAQ,CAAC;MACpB,CAAE;MAAA3B,QAAA,gBAEFR,OAAA,CAACF,OAAO;QAAAgB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACXjB,OAAA;QAAKiC,SAAS,EAAC,0BAA0B;QAAAzB,QAAA,eACvCR,OAAA,CAACN,QAAQ;UACPuC,SAAS,EAAC,sCAAsC;UAChDvB,aAAa,EAAEA,aAAc;UAC7BQ,UAAU,EAAEA,UAAW;UACvBkB,WAAW,EAAC,iBAAiB;UAC7BC,SAAS,EAAEd,aAAc;UACzBe,UAAU,EAAE;QAAM;UAAAxB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnB;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEV,CAAC;AAACd,EAAA,CA/GIF,UAAyC;EAAA,QAU7CJ,WAAW;AAAA;AAAA0C,EAAA,GAVPtC,UAAyC;AAiH/C,eAAeA,UAAU;AAAC,IAAAsC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}